[{"name":"Founder::Stat::Aggr::Model::Blog","defintion":1,"kind":2,"line":0},{"name":"strict","line":1,"containerName":"","kind":2},{"line":2,"containerName":"","kind":2,"name":"warnings"},{"kind":2,"containerName":"","line":3,"name":"utf8"},{"line":5,"kind":2,"containerName":"MR","name":"Log"},{"name":"Type","line":7,"kind":2,"containerName":"MR::ActiveRecordPg"},{"line":8,"containerName":"MR","kind":2,"name":"ActiveRecordPg"},{"name":"Client","kind":2,"containerName":"MR::Clickhouse","line":9},{"line":11,"kind":2,"containerName":"Founder::Service","name":"Type"},{"name":"Config","line":12,"kind":2,"containerName":"Founder"},{"kind":2,"containerName":"Founder","line":13,"name":"Const"},{"line":14,"containerName":"Founder","kind":2,"name":"User"},{"name":"Writer","line":16,"kind":2,"containerName":"Founder::Stat::Aggr"},{"line":17,"kind":2,"containerName":"Founder::Stat::Aggr","name":"Reader"},{"line":18,"kind":12,"name":"with"},{"line":20,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":13,"defintion":"our","name":"$SELECT_RETRY_COUNT"},{"line":22,"kind":12,"name":"db"},{"containerName":"Config::db_pg","kind":12,"line":22,"name":"Founder"},{"line":23,"kind":12,"name":"table"},{"line":25,"kind":12,"name":"has_field"},{"name":"user_id","line":25,"kind":12},{"name":"is","line":25,"kind":12},{"line":25,"kind":12,"name":"isa"},{"name":"required","line":25,"kind":12},{"name":"has_field","kind":12,"line":26},{"name":"date","line":26,"kind":12},{"line":26,"kind":12,"name":"is"},{"line":26,"kind":12,"name":"isa"},{"name":"required","line":26,"kind":12},{"name":"has_field","line":27,"kind":12},{"line":27,"kind":12,"name":"period"},{"line":27,"kind":12,"name":"is"},{"kind":12,"line":27,"name":"isa"},{"name":"required","line":27,"kind":12},{"name":"has_field","line":28,"kind":12},{"line":28,"kind":12,"name":"inc_followers"},{"name":"is","line":28,"kind":12},{"name":"isa","line":28,"kind":12},{"name":"required","line":28,"kind":12},{"name":"default","kind":12,"line":28},{"line":29,"kind":12,"name":"has_field"},{"line":29,"kind":12,"name":"dec_followers"},{"line":29,"kind":12,"name":"is"},{"name":"isa","kind":12,"line":29},{"name":"required","line":29,"kind":12},{"name":"default","kind":12,"line":29},{"kind":12,"line":30,"name":"has_field"},{"name":"inc_subscribers","kind":12,"line":30},{"name":"is","line":30,"kind":12},{"line":30,"kind":12,"name":"isa"},{"line":30,"kind":12,"name":"required"},{"name":"default","line":30,"kind":12},{"kind":12,"line":31,"name":"has_field"},{"kind":12,"line":31,"name":"dec_subscribers"},{"line":31,"kind":12,"name":"is"},{"name":"isa","line":31,"kind":12},{"line":31,"kind":12,"name":"required"},{"line":31,"kind":12,"name":"default"},{"line":32,"kind":12,"name":"has_field"},{"line":32,"kind":12,"name":"add_free_posts"},{"name":"is","kind":12,"line":32},{"line":32,"kind":12,"name":"isa"},{"name":"required","kind":12,"line":32},{"name":"default","kind":12,"line":32},{"name":"has_field","kind":12,"line":33},{"name":"add_paid_posts","line":33,"kind":12},{"kind":12,"line":33,"name":"is"},{"name":"isa","line":33,"kind":12},{"line":33,"kind":12,"name":"required"},{"kind":12,"line":33,"name":"default"},{"line":34,"kind":12,"name":"has_field"},{"name":"start_followers","kind":12,"line":34},{"name":"is","line":34,"kind":12},{"name":"isa","line":34,"kind":12},{"name":"required","kind":12,"line":34},{"name":"default","line":34,"kind":12},{"line":35,"kind":12,"name":"has_field"},{"name":"start_subscribers","kind":12,"line":35},{"line":35,"kind":12,"name":"is"},{"line":35,"kind":12,"name":"isa"},{"kind":12,"line":35,"name":"required"},{"name":"default","line":35,"kind":12},{"line":36,"kind":12,"name":"has_field"},{"line":36,"kind":12,"name":"visits"},{"name":"is","line":36,"kind":12},{"line":36,"kind":12,"name":"isa"},{"kind":12,"line":36,"name":"required"},{"name":"default","line":36,"kind":12},{"name":"has_field","kind":12,"line":37},{"kind":12,"line":37,"name":"inc_subscribers_money"},{"name":"is","kind":12,"line":37},{"name":"isa","line":37,"kind":12},{"name":"required","kind":12,"line":37},{"name":"default","kind":12,"line":37},{"line":38,"kind":12,"name":"has_field"},{"kind":12,"line":38,"name":"up_subscribers"},{"kind":12,"line":38,"name":"is"},{"kind":12,"line":38,"name":"isa"},{"kind":12,"line":38,"name":"required"},{"line":38,"kind":12,"name":"default"},{"line":39,"kind":12,"name":"has_field"},{"name":"up_subscribers_money","line":39,"kind":12},{"name":"is","line":39,"kind":12},{"line":39,"kind":12,"name":"isa"},{"kind":12,"line":39,"name":"required"},{"kind":12,"line":39,"name":"default"},{"name":"has_field","kind":12,"line":40},{"line":40,"kind":12,"name":"recurrents"},{"kind":12,"line":40,"name":"is"},{"name":"isa","kind":12,"line":40},{"name":"required","kind":12,"line":40},{"line":40,"kind":12,"name":"default"},{"name":"has_field","kind":12,"line":41},{"kind":12,"line":41,"name":"recurrents_money"},{"kind":12,"line":41,"name":"is"},{"kind":12,"line":41,"name":"isa"},{"line":41,"kind":12,"name":"required"},{"name":"default","kind":12,"line":41},{"name":"has_field","kind":12,"line":42},{"kind":12,"line":42,"name":"donations"},{"name":"is","line":42,"kind":12},{"name":"isa","kind":12,"line":42},{"line":42,"kind":12,"name":"required"},{"kind":12,"line":42,"name":"default"},{"line":43,"kind":12,"name":"has_field"},{"name":"donations_money","line":43,"kind":12},{"name":"is","line":43,"kind":12},{"line":43,"kind":12,"name":"isa"},{"name":"required","kind":12,"line":43},{"name":"default","kind":12,"line":43},{"name":"has_field","kind":12,"line":44},{"name":"posts_sale","line":44,"kind":12},{"name":"is","kind":12,"line":44},{"kind":12,"line":44,"name":"isa"},{"name":"required","kind":12,"line":44},{"name":"default","line":44,"kind":12},{"line":45,"kind":12,"name":"has_field"},{"kind":12,"line":45,"name":"posts_sale_money"},{"line":45,"kind":12,"name":"is"},{"name":"isa","line":45,"kind":12},{"line":45,"kind":12,"name":"required"},{"name":"default","kind":12,"line":45},{"name":"has_index","line":47,"kind":12},{"kind":12,"line":47,"name":"user_id_period_date_idx"},{"name":"fields","kind":12,"line":48},{"line":49,"kind":12,"name":"selector"},{"name":"primary_key","kind":12,"line":50},{"line":53,"kind":12,"name":"count_subscribers"},{"name":"is","line":54,"kind":12},{"kind":12,"line":55,"name":"isa"},{"name":"lazy","line":56,"kind":12},{"line":57,"kind":12,"name":"default"},{"name":"inc_followers","defintion":"sub","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","children":[],"line":57},{"line":57,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"inc_subscribers"},{"line":60,"kind":12,"name":"count_unsubscribers"},{"name":"is","kind":12,"line":61},{"name":"isa","kind":12,"line":62},{"line":63,"kind":12,"name":"lazy"},{"name":"default","line":64,"kind":12},{"name":"dec_followers","defintion":"sub","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","children":[{"name":"$responser","defintion":"my","kind":13,"containerName":"dec_followers","line":67}],"line":64},{"line":64,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"dec_subscribers"},{"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":67,"name":"meta"},{"line":67,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"select_response"},{"line":68,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","children":[],"defintion":"sub","name":"aggr_field"},{"defintion":"sub","name":"metrics","line":69,"children":[],"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12},{"line":71,"kind":12,"name":"inc_followers"},{"name":"storage","line":72,"kind":12},{"name":"select_by","kind":12,"line":73},{"kind":12,"line":74,"name":"query"},{"name":"_action_id_of_event","kind":12,"line":74},{"name":"dec_followers","kind":12,"line":77},{"kind":12,"line":78,"name":"storage"},{"kind":12,"line":79,"name":"select_by"},{"line":80,"kind":12,"name":"query"},{"line":80,"kind":12,"name":"_action_id_of_event"},{"kind":12,"line":82,"name":"inc_subscribers"},{"line":83,"kind":12,"name":"storage"},{"name":"select_by","line":84,"kind":12},{"line":85,"kind":12,"name":"query"},{"line":85,"kind":12,"name":"_action_id_of_event"},{"name":"dec_subscribers","kind":12,"line":87},{"name":"storage","kind":12,"line":88},{"name":"select_by","line":89,"kind":12},{"name":"query","kind":12,"line":90},{"name":"_action_id_of_event","kind":12,"line":90},{"name":"add_free_posts","line":92,"kind":12},{"kind":12,"line":93,"name":"storage"},{"kind":12,"line":94,"name":"select_by"},{"name":"query","kind":12,"line":95},{"name":"_action_id_of_event","kind":12,"line":95},{"kind":12,"line":97,"name":"add_paid_posts"},{"name":"storage","line":98,"kind":12},{"kind":12,"line":99,"name":"select_by"},{"line":100,"kind":12,"name":"query"},{"line":100,"kind":12,"name":"_action_id_of_event"},{"name":"visits","kind":12,"line":102},{"name":"storage","kind":12,"line":103},{"name":"select_by","kind":12,"line":104},{"name":"query","line":105,"kind":12},{"name":"start_followers","line":107,"kind":12},{"name":"storage","kind":12,"line":108},{"kind":12,"line":109,"name":"not_additive"},{"name":"start_subscribers","line":112,"kind":12},{"kind":12,"line":113,"name":"storage"},{"line":114,"kind":12,"name":"not_additive"},{"line":117,"kind":12,"name":"inc_subscribers_money"},{"name":"storage","line":118,"kind":12},{"name":"select_by","kind":12,"line":119},{"kind":12,"line":120,"name":"query"},{"name":"_action_id_of_event","kind":12,"line":120},{"kind":12,"line":122,"name":"up_subscribers"},{"kind":12,"line":123,"name":"storage"},{"kind":12,"line":124,"name":"select_by"},{"name":"query","kind":12,"line":125},{"kind":12,"line":125,"name":"_action_id_of_event"},{"kind":12,"line":127,"name":"up_subscribers_money"},{"name":"storage","kind":12,"line":128},{"name":"select_by","line":129,"kind":12},{"kind":12,"line":130,"name":"query"},{"kind":12,"line":130,"name":"_action_id_of_event"},{"kind":12,"line":132,"name":"recurrents"},{"kind":12,"line":133,"name":"storage"},{"line":134,"kind":12,"name":"select_by"},{"name":"query","kind":12,"line":135},{"line":135,"kind":12,"name":"_action_id_of_event"},{"name":"recurrents_money","line":137,"kind":12},{"name":"storage","line":138,"kind":12},{"line":139,"kind":12,"name":"select_by"},{"name":"query","kind":12,"line":140},{"kind":12,"line":140,"name":"_action_id_of_event"},{"name":"donations","line":142,"kind":12},{"name":"storage","kind":12,"line":143},{"line":144,"kind":12,"name":"select_by"},{"name":"query","kind":12,"line":145},{"kind":12,"line":145,"name":"_action_id_of_event"},{"name":"donations_money","line":147,"kind":12},{"kind":12,"line":148,"name":"storage"},{"kind":12,"line":149,"name":"select_by"},{"name":"query","line":150,"kind":12},{"name":"_action_id_of_event","kind":12,"line":150},{"kind":12,"line":152,"name":"posts_sale"},{"name":"storage","kind":12,"line":153},{"name":"select_by","line":154,"kind":12},{"name":"query","line":155,"kind":12},{"line":155,"kind":12,"name":"_action_id_of_event"},{"name":"posts_sale_money","kind":12,"line":157},{"kind":12,"line":158,"name":"storage"},{"kind":12,"line":159,"name":"select_by"},{"name":"query","line":160,"kind":12},{"name":"_action_id_of_event","kind":12,"line":160},{"children":[{"defintion":"my","name":"$class","line":167,"kind":13,"containerName":"_get_dummy_answer"},{"name":"$blogger_ids","kind":13,"containerName":"_get_dummy_answer","line":167},{"name":"$start_ts","kind":13,"containerName":"_get_dummy_answer","line":167},{"name":"$period","kind":13,"containerName":"_get_dummy_answer","line":167},{"line":169,"containerName":"_get_dummy_answer","kind":13,"defintion":"my","name":"%default"},{"name":"$class","line":169,"kind":13,"containerName":"_get_dummy_answer"},{"defintion":"my","name":"$aggr_stat","line":170,"containerName":"_get_dummy_answer","kind":13},{"line":170,"containerName":"_get_dummy_answer","kind":13,"name":"%default"},{"kind":13,"containerName":"_get_dummy_answer","line":170,"name":"$start_ts"},{"line":170,"containerName":"_get_dummy_answer","kind":13,"name":"$period"},{"name":"$blogger_ids","kind":13,"containerName":"_get_dummy_answer","line":170},{"name":"$aggr_stat","containerName":"_get_dummy_answer","kind":13,"line":171}],"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":166,"name":"_get_dummy_answer","defintion":"sub"},{"line":169,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"metrics"},{"name":"user_id","kind":12,"line":170},{"name":"date","line":170,"kind":12},{"line":170,"kind":12,"name":"period"},{"line":174,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"children":[{"name":"$class","defintion":"my","containerName":"aggregate_period","kind":13,"line":175},{"line":175,"kind":13,"containerName":"aggregate_period","name":"$blogger_id"},{"line":175,"containerName":"aggregate_period","kind":13,"name":"$date_time"},{"line":175,"containerName":"aggregate_period","kind":13,"name":"$period"},{"name":"$tz_mins","line":175,"kind":13,"containerName":"aggregate_period"},{"line":176,"containerName":"aggregate_period","kind":13,"defintion":"my","name":"$result"},{"line":176,"containerName":"aggregate_period","kind":13,"name":"$class"},{"line":176,"containerName":"aggregate_period","kind":13,"name":"$blogger_id"},{"name":"$date_time","line":176,"containerName":"aggregate_period","kind":13},{"name":"$period","line":176,"containerName":"aggregate_period","kind":13},{"name":"$tz_mins","line":176,"kind":13,"containerName":"aggregate_period"},{"kind":13,"containerName":"aggregate_period","line":177,"name":"$result"},{"name":"$result","line":178,"containerName":"aggregate_period","kind":13}],"defintion":"sub","name":"aggregate_period"},{"name":"bulk_aggregate_period","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":176},{"children":[{"defintion":"my","name":"$class","line":182,"kind":13,"containerName":"bulk_aggregate_period"},{"line":182,"kind":13,"containerName":"bulk_aggregate_period","name":"$blogger_ids"},{"name":"$date_time","kind":13,"containerName":"bulk_aggregate_period","line":182},{"line":182,"containerName":"bulk_aggregate_period","kind":13,"name":"$period"},{"name":"$tz_mins","kind":13,"containerName":"bulk_aggregate_period","line":182},{"kind":13,"containerName":"bulk_aggregate_period","line":183,"name":"$result","defintion":"my"},{"name":"$period","kind":13,"containerName":"bulk_aggregate_period","line":184},{"name":"$result","line":185,"kind":13,"containerName":"bulk_aggregate_period"},{"line":185,"kind":13,"containerName":"bulk_aggregate_period","name":"$class"},{"name":"$blogger_ids","line":185,"containerName":"bulk_aggregate_period","kind":13},{"name":"$date_time","containerName":"bulk_aggregate_period","kind":13,"line":185},{"name":"$tz_mins","line":185,"kind":13,"containerName":"bulk_aggregate_period"},{"name":"$period","line":186,"kind":13,"containerName":"bulk_aggregate_period"},{"name":"$result","kind":13,"containerName":"bulk_aggregate_period","line":187},{"name":"$class","line":187,"containerName":"bulk_aggregate_period","kind":13},{"name":"$blogger_ids","line":187,"kind":13,"containerName":"bulk_aggregate_period"},{"name":"$date_time","line":187,"kind":13,"containerName":"bulk_aggregate_period"},{"name":"$period","kind":13,"containerName":"bulk_aggregate_period","line":187},{"containerName":"bulk_aggregate_period","kind":13,"line":187,"name":"$tz_mins"},{"name":"$result","kind":13,"containerName":"bulk_aggregate_period","line":191}],"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":181,"name":"bulk_aggregate_period","defintion":"sub"},{"line":185,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"bulk_aggregate_day"},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":187,"name":"bulk_aggregate_week_month"},{"line":194,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","children":[{"containerName":"bulk_aggregate_day","kind":13,"line":195,"name":"$class","defintion":"my"},{"line":195,"containerName":"bulk_aggregate_day","kind":13,"name":"$blogger_ids"},{"line":195,"kind":13,"containerName":"bulk_aggregate_day","name":"$date_time"},{"name":"$tz_mins","containerName":"bulk_aggregate_day","kind":13,"line":195},{"kind":13,"containerName":"bulk_aggregate_day","line":196,"name":"$blogger_ids"},{"name":"$blogger_ids","line":196,"containerName":"bulk_aggregate_day","kind":13},{"name":"$blogger_ids","line":196,"kind":13,"containerName":"bulk_aggregate_day"},{"containerName":"bulk_aggregate_day","kind":13,"line":198,"name":"$start_ts","defintion":"my"},{"name":"$date","line":198,"kind":13,"containerName":"bulk_aggregate_day"},{"name":"$time_where","kind":13,"containerName":"bulk_aggregate_day","line":198},{"name":"$date_where","containerName":"bulk_aggregate_day","kind":13,"line":198},{"name":"$class","line":198,"containerName":"bulk_aggregate_day","kind":13},{"kind":13,"containerName":"bulk_aggregate_day","line":198,"name":"$date_time"},{"name":"$tz_mins","kind":13,"containerName":"bulk_aggregate_day","line":198},{"kind":13,"containerName":"bulk_aggregate_day","line":201,"name":"$aggr_stat","defintion":"my"},{"name":"$class","line":201,"containerName":"bulk_aggregate_day","kind":13},{"containerName":"bulk_aggregate_day","kind":13,"line":201,"name":"$blogger_ids"},{"line":201,"containerName":"bulk_aggregate_day","kind":13,"name":"$start_ts"},{"line":204,"containerName":"bulk_aggregate_day","kind":13,"defintion":"my","name":"$metrics"},{"name":"$class","line":204,"kind":13,"containerName":"bulk_aggregate_day"},{"defintion":"my","name":"$clickhouse_metrics","line":205,"kind":13,"containerName":"bulk_aggregate_day"},{"name":"$metrics","line":205,"containerName":"bulk_aggregate_day","kind":13},{"line":206,"containerName":"bulk_aggregate_day","kind":13,"name":"$aggr_stat"},{"name":"$class","containerName":"bulk_aggregate_day","kind":13,"line":206},{"name":"$aggr_stat","containerName":"bulk_aggregate_day","kind":13,"line":206},{"containerName":"bulk_aggregate_day","kind":13,"line":206,"name":"$blogger_ids"},{"name":"$date_where","line":206,"kind":13,"containerName":"bulk_aggregate_day"},{"name":"$clickhouse_metrics","line":206,"containerName":"bulk_aggregate_day","kind":13},{"name":"$aggr_stat","containerName":"bulk_aggregate_day","kind":13,"line":207},{"name":"$aggr_stat","kind":13,"containerName":"bulk_aggregate_day","line":210},{"name":"$class","containerName":"bulk_aggregate_day","kind":13,"line":210},{"name":"$aggr_stat","line":210,"containerName":"bulk_aggregate_day","kind":13},{"name":"$blogger_ids","kind":13,"containerName":"bulk_aggregate_day","line":210},{"name":"$date","kind":13,"containerName":"bulk_aggregate_day","line":210},{"defintion":"my","name":"$response","line":212,"containerName":"bulk_aggregate_day","kind":13},{"kind":13,"containerName":"bulk_aggregate_day","line":212,"name":"$aggr_stat"},{"name":"$response","line":213,"kind":13,"containerName":"bulk_aggregate_day"}],"defintion":"sub","name":"bulk_aggregate_day"},{"name":"_get_period_times","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":198},{"line":201,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"_get_dummy_answer"},{"name":"metrics","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":204},{"line":205,"kind":12,"name":"storage"},{"line":206,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"_get_stat_from_clickhouse"},{"name":"_get_start_counters","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":210},{"children":[{"line":217,"kind":13,"containerName":"bulk_aggregate_week_month","defintion":"my","name":"$class"},{"line":217,"containerName":"bulk_aggregate_week_month","kind":13,"name":"$blogger_ids"},{"name":"$date_time","line":217,"kind":13,"containerName":"bulk_aggregate_week_month"},{"name":"$period","line":217,"kind":13,"containerName":"bulk_aggregate_week_month"},{"line":217,"kind":13,"containerName":"bulk_aggregate_week_month","name":"$tz_mins"},{"name":"$blogger_ids","kind":13,"containerName":"bulk_aggregate_week_month","line":218},{"line":218,"kind":13,"containerName":"bulk_aggregate_week_month","name":"$blogger_ids"},{"name":"$blogger_ids","containerName":"bulk_aggregate_week_month","kind":13,"line":218},{"containerName":"bulk_aggregate_week_month","kind":13,"line":221,"name":"$start_ts","defintion":"my"},{"line":221,"containerName":"bulk_aggregate_week_month","kind":13,"name":"$date"},{"name":"$time_where","kind":13,"containerName":"bulk_aggregate_week_month","line":221},{"name":"$date_where","line":221,"kind":13,"containerName":"bulk_aggregate_week_month"},{"name":"$class","kind":13,"containerName":"bulk_aggregate_week_month","line":221},{"name":"$period","kind":13,"containerName":"bulk_aggregate_week_month","line":221},{"kind":13,"containerName":"bulk_aggregate_week_month","line":221,"name":"$date_time"},{"name":"$tz_mins","kind":13,"containerName":"bulk_aggregate_week_month","line":221},{"name":"$metrics","defintion":"my","kind":13,"containerName":"bulk_aggregate_week_month","line":224},{"line":224,"containerName":"bulk_aggregate_week_month","kind":13,"name":"$class"},{"name":"$postgres_metrics","defintion":"my","kind":13,"containerName":"bulk_aggregate_week_month","line":225},{"line":225,"containerName":"bulk_aggregate_week_month","kind":13,"name":"$metrics"},{"containerName":"bulk_aggregate_week_month","kind":13,"line":226,"name":"$clickhouse_metrics","defintion":"my"},{"kind":13,"containerName":"bulk_aggregate_week_month","line":229,"name":"$aggr_stat","defintion":"my"},{"name":"$class","line":229,"containerName":"bulk_aggregate_week_month","kind":13},{"line":229,"containerName":"bulk_aggregate_week_month","kind":13,"name":"$blogger_ids"},{"kind":13,"containerName":"bulk_aggregate_week_month","line":229,"name":"$start_ts"},{"name":"$period","line":229,"containerName":"bulk_aggregate_week_month","kind":13},{"kind":13,"containerName":"bulk_aggregate_week_month","line":232,"name":"$aggr_stat"},{"kind":13,"containerName":"bulk_aggregate_week_month","line":232,"name":"$class"},{"name":"$aggr_stat","containerName":"bulk_aggregate_week_month","kind":13,"line":232},{"kind":13,"containerName":"bulk_aggregate_week_month","line":232,"name":"$blogger_ids"},{"kind":13,"containerName":"bulk_aggregate_week_month","line":232,"name":"$date_where"},{"kind":13,"containerName":"bulk_aggregate_week_month","line":232,"name":"$postgres_metrics"},{"name":"$aggr_stat","kind":13,"containerName":"bulk_aggregate_week_month","line":235},{"name":"$class","containerName":"bulk_aggregate_week_month","kind":13,"line":235},{"containerName":"bulk_aggregate_week_month","kind":13,"line":235,"name":"$aggr_stat"},{"name":"$blogger_ids","line":235,"containerName":"bulk_aggregate_week_month","kind":13},{"name":"$time_where","containerName":"bulk_aggregate_week_month","kind":13,"line":235},{"kind":13,"containerName":"bulk_aggregate_week_month","line":235,"name":"$clickhouse_metrics"},{"containerName":"bulk_aggregate_week_month","kind":13,"line":236,"name":"$aggr_stat"},{"name":"$aggr_stat","line":239,"kind":13,"containerName":"bulk_aggregate_week_month"},{"containerName":"bulk_aggregate_week_month","kind":13,"line":239,"name":"$class"},{"line":239,"containerName":"bulk_aggregate_week_month","kind":13,"name":"$aggr_stat"},{"name":"$blogger_ids","kind":13,"containerName":"bulk_aggregate_week_month","line":239},{"containerName":"bulk_aggregate_week_month","kind":13,"line":239,"name":"$date"},{"containerName":"bulk_aggregate_week_month","kind":13,"line":241,"name":"$response","defintion":"my"},{"name":"$aggr_stat","line":241,"kind":13,"containerName":"bulk_aggregate_week_month"},{"name":"$response","line":242,"containerName":"bulk_aggregate_week_month","kind":13}],"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":216,"name":"bulk_aggregate_week_month","defintion":"sub"},{"name":"_get_period_times","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":221},{"name":"metrics","line":224,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"},{"name":"storage","line":225,"kind":12},{"name":"_get_dummy_answer","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":229},{"line":232,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"_get_stat_from_postgres"},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":235,"name":"_get_stat_from_clickhouse"},{"name":"_get_start_counters","line":239,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12},{"defintion":"sub","name":"_get_stat_from_postgres","line":245,"children":[{"line":246,"kind":13,"containerName":"_get_stat_from_postgres","defintion":"my","name":"$class"},{"line":246,"containerName":"_get_stat_from_postgres","kind":13,"name":"$aggr_stat"},{"line":246,"containerName":"_get_stat_from_postgres","kind":13,"name":"$blogger_ids"},{"line":246,"containerName":"_get_stat_from_postgres","kind":13,"name":"$where_dates"},{"name":"$postgres_metrics","line":246,"kind":13,"containerName":"_get_stat_from_postgres"},{"kind":13,"containerName":"_get_stat_from_postgres","line":248,"name":"$aggr_stat"},{"containerName":"_get_stat_from_postgres","kind":13,"line":248,"name":"$postgres_metrics"},{"name":"$postgres_metrics","kind":13,"containerName":"_get_stat_from_postgres","line":248},{"defintion":"my","name":"@aggr_metrics","line":250,"kind":13,"containerName":"_get_stat_from_postgres"},{"name":"$postgres_metrics","kind":13,"containerName":"_get_stat_from_postgres","line":250},{"line":251,"kind":13,"containerName":"_get_stat_from_postgres","defintion":"my","name":"$cols_string"},{"name":"@aggr_metrics","containerName":"_get_stat_from_postgres","kind":13,"line":251},{"line":252,"kind":13,"containerName":"_get_stat_from_postgres","defintion":"my","name":"@cols"},{"kind":13,"containerName":"_get_stat_from_postgres","line":252,"name":"@aggr_metrics"},{"name":"$blogger_ids_string","defintion":"my","kind":13,"containerName":"_get_stat_from_postgres","line":253},{"name":"$blogger_ids","kind":13,"containerName":"_get_stat_from_postgres","line":253},{"kind":13,"containerName":"_get_stat_from_postgres","line":255,"name":"$table","defintion":"my"},{"containerName":"_get_stat_from_postgres","kind":13,"line":256,"name":"$q","defintion":"my"},{"defintion":"my","name":"$data","line":257,"kind":13,"containerName":"_get_stat_from_postgres"},{"name":"$q","kind":13,"containerName":"_get_stat_from_postgres","line":258},{"name":"$aggr_stat","kind":13,"containerName":"_get_stat_from_postgres","line":261},{"name":"$data","containerName":"_get_stat_from_postgres","kind":13,"line":261},{"name":"$line","defintion":"my","kind":13,"containerName":"_get_stat_from_postgres","line":263},{"line":263,"kind":13,"containerName":"_get_stat_from_postgres","name":"$data"},{"name":"$user_id","defintion":"my","containerName":"_get_stat_from_postgres","kind":13,"line":264},{"name":"$line","line":264,"containerName":"_get_stat_from_postgres","kind":13},{"defintion":"my","name":"$i","line":265,"kind":13,"containerName":"_get_stat_from_postgres"},{"containerName":"_get_stat_from_postgres","kind":13,"line":265,"name":"$i"},{"name":"$line","kind":13,"containerName":"_get_stat_from_postgres","line":265},{"line":265,"containerName":"_get_stat_from_postgres","kind":13,"name":"$i"},{"name":"$aggr_stat","line":266,"kind":13,"containerName":"_get_stat_from_postgres"},{"name":"$user_id","line":266,"containerName":"_get_stat_from_postgres","kind":13},{"name":"$cols","kind":13,"containerName":"_get_stat_from_postgres","line":266},{"kind":13,"containerName":"_get_stat_from_postgres","line":266,"name":"$i"},{"containerName":"_get_stat_from_postgres","kind":13,"line":266,"name":"$line"},{"line":266,"containerName":"_get_stat_from_postgres","kind":13,"name":"$i"},{"name":"$aggr_stat","line":269,"kind":13,"containerName":"_get_stat_from_postgres"}],"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12},{"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":255,"name":"meta"},{"name":"table","line":255,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":257,"name":"meta"},{"name":"db_class","line":257,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"},{"line":257,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"selectall_arrayref"},{"name":"meta","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":257},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":257,"name":"db"},{"line":258,"kind":12,"name":"query"},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","children":[{"kind":13,"containerName":"_get_stat_from_clickhouse","line":273,"name":"$class","defintion":"my"},{"name":"$aggr_stat","line":273,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":273,"name":"$blogger_ids"},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":273,"name":"$where_times"},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":273,"name":"$clickhouse_metrics"},{"line":275,"containerName":"_get_stat_from_clickhouse","kind":13,"defintion":"my","name":"$users"},{"name":"$blogger_ids","line":275,"containerName":"_get_stat_from_clickhouse","kind":13},{"name":"%id_to_url","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":276},{"name":"$users","line":276,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"name":"%url_to_id","defintion":"my","containerName":"_get_stat_from_clickhouse","kind":13,"line":277},{"name":"%id_to_url","line":277,"containerName":"_get_stat_from_clickhouse","kind":13},{"name":"$metrics","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":279},{"name":"$class","line":279,"containerName":"_get_stat_from_clickhouse","kind":13},{"name":"@clickhouse_metrics","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":280},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":280,"name":"$clickhouse_metrics"},{"line":282,"containerName":"_get_stat_from_clickhouse","kind":13,"defintion":"my","name":"@clickhouse_queries"},{"line":283,"containerName":"_get_stat_from_clickhouse","kind":13,"defintion":"my","name":"$m_name"},{"name":"@clickhouse_metrics","kind":13,"containerName":"_get_stat_from_clickhouse","line":283},{"line":284,"kind":13,"containerName":"_get_stat_from_clickhouse","defintion":"my","name":"$metric"},{"name":"$metrics","line":284,"containerName":"_get_stat_from_clickhouse","kind":13},{"line":284,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$m_name"},{"name":"$where_in","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":285},{"name":"$metric","line":286,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"line":287,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$where_in"},{"line":288,"containerName":"_get_stat_from_clickhouse","kind":13,"name":"%id_to_url"},{"line":288,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$metric"},{"line":289,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$where_in"},{"name":"%url_to_id","kind":13,"containerName":"_get_stat_from_clickhouse","line":290},{"name":"@clickhouse_queries","line":291,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":291,"name":"$metric"},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":291,"name":"$where_times"},{"name":"$where_in","line":291,"containerName":"_get_stat_from_clickhouse","kind":13},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":293,"name":"$raw_clickhouse_metrics","defintion":"my"},{"name":"$retry_no","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":294},{"name":"$SELECT_RETRY_COUNT","line":294,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"name":"$raw_clickhouse_metrics","line":295,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"line":295,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"@clickhouse_queries"},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":296,"name":"$raw_clickhouse_metrics"},{"line":297,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$retry_no"},{"name":"$SELECT_RETRY_COUNT","line":297,"containerName":"_get_stat_from_clickhouse","kind":13},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":300,"name":"$i","defintion":"my"},{"name":"$m_name","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":301},{"name":"$clickhouse_metrics","containerName":"_get_stat_from_clickhouse","kind":13,"line":301},{"name":"$i","line":301,"containerName":"_get_stat_from_clickhouse","kind":13},{"name":"$metric","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse","line":302},{"line":302,"containerName":"_get_stat_from_clickhouse","kind":13,"name":"$metrics"},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":302,"name":"$m_name"},{"defintion":"my","name":"$metric_stat","line":303,"containerName":"_get_stat_from_clickhouse","kind":13},{"name":"$raw_clickhouse_metrics","line":303,"kind":13,"containerName":"_get_stat_from_clickhouse"},{"name":"$i","line":303,"containerName":"_get_stat_from_clickhouse","kind":13},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":304,"name":"$line","defintion":"my"},{"name":"$metric_stat","kind":13,"containerName":"_get_stat_from_clickhouse","line":304},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":305,"name":"$blogger","defintion":"my"},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":305,"name":"$value"},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":305,"name":"$line"},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":306,"name":"$id","defintion":"my"},{"line":307,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$metric"},{"line":308,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$id"},{"name":"$blogger","containerName":"_get_stat_from_clickhouse","kind":13,"line":308},{"line":309,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$metric"},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":310,"name":"$id"},{"name":"$url_to_id","line":310,"containerName":"_get_stat_from_clickhouse","kind":13},{"line":310,"containerName":"_get_stat_from_clickhouse","kind":13,"name":"$blogger"},{"line":312,"kind":13,"containerName":"_get_stat_from_clickhouse","name":"$aggr_stat"},{"name":"$id","line":312,"containerName":"_get_stat_from_clickhouse","kind":13},{"kind":13,"containerName":"_get_stat_from_clickhouse","line":312,"name":"$m_name"},{"containerName":"_get_stat_from_clickhouse","kind":13,"line":312,"name":"$value"},{"name":"$aggr_stat","containerName":"_get_stat_from_clickhouse","kind":13,"line":315}],"line":272,"name":"_get_stat_from_clickhouse","defintion":"sub"},{"name":"Founder","containerName":"User","kind":12,"line":275},{"name":"select_by_id","line":275,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"},{"name":"id","line":276,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12},{"name":"url","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":276},{"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":276,"name":"url"},{"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":279,"name":"metrics"},{"name":"select_by","kind":12,"line":286},{"line":288,"kind":12,"name":"select_by"},{"name":"query","line":291,"kind":12},{"containerName":"Clickhouse::Client","kind":12,"line":295,"name":"MR"},{"name":"send_query","line":295,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"},{"name":"clickhouse_metrics","line":300,"kind":12},{"line":307,"kind":12,"name":"select_by"},{"kind":12,"line":309,"name":"select_by"},{"line":318,"children":[{"defintion":"my","name":"$class","line":319,"kind":13,"containerName":"_get_start_counters"},{"containerName":"_get_start_counters","kind":13,"line":319,"name":"$aggr_stat"},{"containerName":"_get_start_counters","kind":13,"line":319,"name":"$blogger_ids"},{"name":"$date","line":319,"kind":13,"containerName":"_get_start_counters"},{"containerName":"_get_start_counters","kind":13,"line":321,"name":"$user_id","defintion":"my"},{"name":"$blogger_ids","line":321,"containerName":"_get_start_counters","kind":13},{"line":322,"kind":13,"containerName":"_get_start_counters","defintion":"my","name":"$start_followers"},{"line":322,"containerName":"_get_start_counters","kind":13,"name":"$start_subscribers"},{"name":"$user_id","containerName":"_get_start_counters","kind":13,"line":322},{"name":"$date","line":322,"containerName":"_get_start_counters","kind":13},{"name":"$aggr_stat","line":323,"kind":13,"containerName":"_get_start_counters"},{"kind":13,"containerName":"_get_start_counters","line":323,"name":"$user_id"},{"name":"$start_followers","line":323,"containerName":"_get_start_counters","kind":13},{"kind":13,"containerName":"_get_start_counters","line":324,"name":"$aggr_stat"},{"name":"$user_id","line":324,"kind":13,"containerName":"_get_start_counters"},{"line":324,"kind":13,"containerName":"_get_start_counters","name":"$start_subscribers"},{"kind":13,"containerName":"_get_start_counters","line":327,"name":"$aggr_stat"}],"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"defintion":"sub","name":"_get_start_counters"},{"name":"_get_start_counters_for_user","line":322,"kind":12},{"kind":12,"line":323,"name":"start_followers"},{"kind":12,"line":324,"name":"start_subscribers"},{"defintion":"sub","name":"_get_start_counters_for_user","line":330,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"children":[{"defintion":"my","name":"$user_id","line":331,"kind":13,"containerName":"_get_start_counters_for_user"},{"name":"$date","kind":13,"containerName":"_get_start_counters_for_user","line":331},{"defintion":"my","name":"$table","line":333,"kind":13,"containerName":"_get_start_counters_for_user"},{"defintion":"my","name":"$q","line":334,"containerName":"_get_start_counters_for_user","kind":13},{"containerName":"_get_start_counters_for_user","kind":13,"line":335,"name":"$data","defintion":"my"},{"name":"$q","line":336,"kind":13,"containerName":"_get_start_counters_for_user"},{"kind":13,"containerName":"_get_start_counters_for_user","line":338,"name":"$r","defintion":"my"},{"line":338,"containerName":"_get_start_counters_for_user","kind":13,"name":"$responser"},{"name":"$data","kind":13,"containerName":"_get_start_counters_for_user","line":338},{"kind":13,"containerName":"_get_start_counters_for_user","line":340,"name":"$r"},{"line":342,"containerName":"_get_start_counters_for_user","kind":13,"defintion":"my","name":"$start_followers"},{"name":"$r","line":342,"containerName":"_get_start_counters_for_user","kind":13},{"name":"$r","containerName":"_get_start_counters_for_user","kind":13,"line":342},{"line":342,"containerName":"_get_start_counters_for_user","kind":13,"name":"$r"},{"line":343,"containerName":"_get_start_counters_for_user","kind":13,"defintion":"my","name":"$start_subscribers"},{"name":"$r","kind":13,"containerName":"_get_start_counters_for_user","line":343},{"containerName":"_get_start_counters_for_user","kind":13,"line":343,"name":"$r"},{"line":343,"kind":13,"containerName":"_get_start_counters_for_user","name":"$r"},{"kind":13,"containerName":"_get_start_counters_for_user","line":346,"name":"$start_followers"},{"line":346,"kind":13,"containerName":"_get_start_counters_for_user","name":"$start_followers"},{"name":"$start_subscribers","containerName":"_get_start_counters_for_user","kind":13,"line":347},{"name":"$start_subscribers","line":347,"kind":13,"containerName":"_get_start_counters_for_user"},{"line":350,"containerName":"_get_start_counters_for_user","kind":13,"name":"$start_followers"},{"name":"$start_subscribers","line":350,"containerName":"_get_start_counters_for_user","kind":13}]},{"name":"meta","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":333},{"name":"table","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":333},{"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":335,"name":"meta"},{"line":335,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"db_class"},{"name":"selectall_arrayref","line":335,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":335,"name":"meta"},{"name":"db","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":335},{"line":336,"kind":12,"name":"query"},{"line":336,"kind":12,"name":"__PACKAGE__"},{"line":336,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"meta"},{"name":"select_fields","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":336},{"name":"start_followers","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":342},{"line":342,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"inc_followers"},{"name":"dec_followers","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":342},{"name":"start_subscribers","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":343},{"line":343,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"name":"inc_subscribers"},{"name":"dec_subscribers","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":343},{"line":353,"children":[{"defintion":"my","name":"$event_name","line":354,"kind":13,"containerName":"_action_id_of_event"},{"containerName":"_action_id_of_event","kind":13,"line":355,"name":"$action_id","defintion":"my"},{"name":"$action_id","line":357,"kind":13,"containerName":"_action_id_of_event"},{"name":"$event_name","line":357,"containerName":"_action_id_of_event","kind":13},{"line":360,"containerName":"_action_id_of_event","kind":13,"name":"$action_id"},{"name":"$action_id","line":361,"containerName":"_action_id_of_event","kind":13}],"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"defintion":"sub","name":"_action_id_of_event"},{"line":357,"kind":12,"name":"id"},{"name":"log_error","kind":12,"line":359},{"name":"log_error","kind":12,"line":360},{"name":"BEGIN_FIX_TS","defintion":1,"kind":14,"containerName":"Founder::Stat::Aggr::Model::Blog","line":364},{"line":365,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":14,"defintion":1,"name":"END_FIX_TS"},{"defintion":"sub","name":"recalc_stat_time_period","line":367,"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"children":[{"defintion":"my","name":"$class","line":368,"kind":13,"containerName":"recalc_stat_time_period"},{"name":"%params","line":368,"containerName":"recalc_stat_time_period","kind":13},{"defintion":"my","name":"$ids","line":369,"containerName":"recalc_stat_time_period","kind":13},{"line":369,"kind":13,"containerName":"recalc_stat_time_period","name":"$params"},{"containerName":"recalc_stat_time_period","kind":13,"line":370,"name":"$tz_mins","defintion":"my"},{"containerName":"recalc_stat_time_period","kind":13,"line":370,"name":"$params"},{"containerName":"recalc_stat_time_period","kind":13,"line":371,"name":"$stop_dt","defintion":"my"},{"line":371,"kind":13,"containerName":"recalc_stat_time_period","name":"$params"},{"defintion":"my","name":"$start_dt","line":372,"kind":13,"containerName":"recalc_stat_time_period"},{"name":"$params","line":372,"containerName":"recalc_stat_time_period","kind":13},{"name":"$period","defintion":"my","kind":13,"containerName":"recalc_stat_time_period","line":374},{"kind":13,"containerName":"recalc_stat_time_period","line":375,"name":"$cur_dt","defintion":"my"},{"line":375,"kind":13,"containerName":"recalc_stat_time_period","name":"$start_dt"},{"containerName":"recalc_stat_time_period","kind":13,"line":376,"name":"$cur_dt"},{"line":376,"kind":13,"containerName":"recalc_stat_time_period","name":"$stop_dt"},{"kind":13,"containerName":"recalc_stat_time_period","line":376,"name":"$ids"},{"line":378,"kind":13,"containerName":"recalc_stat_time_period","name":"$cur_dt"},{"containerName":"recalc_stat_time_period","kind":13,"line":378,"name":"$stop_dt"},{"containerName":"recalc_stat_time_period","kind":13,"line":379,"name":"$result","defintion":"my"},{"name":"$ids","line":379,"kind":13,"containerName":"recalc_stat_time_period"},{"name":"$cur_dt","kind":13,"containerName":"recalc_stat_time_period","line":379},{"line":379,"containerName":"recalc_stat_time_period","kind":13,"name":"$period"},{"kind":13,"containerName":"recalc_stat_time_period","line":379,"name":"$tz_mins"},{"kind":13,"containerName":"recalc_stat_time_period","line":380,"name":"$result"},{"name":"$start_ts","defintion":"my","kind":13,"containerName":"recalc_stat_time_period","line":381},{"line":381,"kind":13,"containerName":"recalc_stat_time_period","name":"$date"},{"name":"$time_where","containerName":"recalc_stat_time_period","kind":13,"line":381},{"kind":13,"containerName":"recalc_stat_time_period","line":381,"name":"$date_where"},{"line":381,"containerName":"recalc_stat_time_period","kind":13,"name":"$period"},{"kind":13,"containerName":"recalc_stat_time_period","line":381,"name":"$cur_dt"},{"containerName":"recalc_stat_time_period","kind":13,"line":381,"name":"$tz_mins"},{"line":382,"kind":13,"containerName":"recalc_stat_time_period","defintion":"my","name":"$user"},{"name":"$result","line":382,"containerName":"recalc_stat_time_period","kind":13},{"name":"$start_ts","line":383,"kind":13,"containerName":"recalc_stat_time_period"},{"name":"$start_ts","containerName":"recalc_stat_time_period","kind":13,"line":383},{"name":"$up_sub","defintion":"my","kind":13,"containerName":"recalc_stat_time_period","line":384},{"line":384,"kind":13,"containerName":"recalc_stat_time_period","name":"$up_money"},{"name":"$user","containerName":"recalc_stat_time_period","kind":13,"line":384},{"name":"$time_where","line":384,"containerName":"recalc_stat_time_period","kind":13},{"name":"$up_sub","line":387,"kind":13,"containerName":"recalc_stat_time_period"},{"kind":13,"containerName":"recalc_stat_time_period","line":389,"name":"$user"},{"name":"$up_sub","line":389,"kind":13,"containerName":"recalc_stat_time_period"},{"kind":13,"containerName":"recalc_stat_time_period","line":390,"name":"$user"},{"containerName":"recalc_stat_time_period","kind":13,"line":390,"name":"$up_money"},{"name":"$start_ts","line":391,"kind":13,"containerName":"recalc_stat_time_period"},{"name":"$user","line":392,"containerName":"recalc_stat_time_period","kind":13},{"line":393,"containerName":"recalc_stat_time_period","kind":13,"name":"$user"},{"name":"$user","containerName":"recalc_stat_time_period","kind":13,"line":395},{"line":397,"containerName":"recalc_stat_time_period","kind":13,"name":"$cur_dt"},{"name":"$cur_dt","containerName":"recalc_stat_time_period","kind":13,"line":398},{"containerName":"recalc_stat_time_period","kind":13,"line":398,"name":"$period"}]},{"line":369,"kind":12,"name":"ids"},{"line":370,"kind":12,"name":"tz_mins"},{"kind":12,"line":371,"name":"stop_dt"},{"name":"start_dt","line":372,"kind":12},{"line":375,"kind":12,"name":"DateTime"},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":375,"name":"from_object"},{"kind":12,"line":375,"name":"object"},{"kind":12,"line":376,"name":"log_info"},{"name":"ymd","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":376},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":376,"name":"ymd"},{"name":"Founder","line":379,"containerName":"Stat::Aggr::Model::Blog","kind":12},{"name":"bulk_aggregate_period","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":379},{"line":381,"kind":12,"containerName":"Stat::Aggr::Model::Blog","name":"Founder"},{"name":"_get_period_times","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":381},{"name":"BEGIN_FIX_TS","kind":12,"line":383},{"kind":12,"line":383,"name":"END_FIX_TS"},{"name":"_get_stat_from_clickhouse_fix","kind":12,"line":384},{"line":384,"kind":12,"name":"user_id"},{"name":"up_subscribers","kind":12,"line":389},{"name":"up_subscribers_money","line":390,"kind":12},{"name":"BEGIN_FIX_TS","line":391,"kind":12},{"name":"up_subscribers","line":392,"kind":12},{"kind":12,"line":393,"name":"up_subscribers_money"},{"name":"Founder","line":395,"containerName":"Stat::Aggr::Model::Blog","kind":12},{"name":"new","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":395},{"line":395,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"replace"},{"line":397,"kind":12,"name":"log_info"},{"name":"ymd","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":397},{"name":"add","line":398,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"},{"defintion":"sub","name":"_get_stat_from_clickhouse_fix","line":403,"children":[{"line":404,"kind":13,"containerName":"_get_stat_from_clickhouse_fix","defintion":"my","name":"$user_id"},{"name":"$where_dates","containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":404},{"defintion":"my","name":"$levels","line":405,"containerName":"_get_stat_from_clickhouse_fix","kind":13},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":405,"name":"$user_id"},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":406,"name":"$levels"},{"name":"$levels","kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":406},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":407,"name":"$levels"},{"line":407,"kind":13,"containerName":"_get_stat_from_clickhouse_fix","name":"$a"},{"kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":407,"name":"$b"},{"name":"$levels","line":407,"containerName":"_get_stat_from_clickhouse_fix","kind":13},{"name":"$levels","line":408,"kind":13,"containerName":"_get_stat_from_clickhouse_fix"},{"name":"$cond","defintion":"my","kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":409},{"line":410,"kind":13,"containerName":"_get_stat_from_clickhouse_fix","defintion":"my","name":"$i"},{"kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":410,"name":"$levels"},{"kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":411,"name":"$j","defintion":"my"},{"line":411,"containerName":"_get_stat_from_clickhouse_fix","kind":13,"name":"$i"},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":411,"name":"$levels"},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":412,"name":"$cond"},{"line":412,"kind":13,"containerName":"_get_stat_from_clickhouse_fix","name":"$levels"},{"name":"$i","kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":412},{"name":"$levels","containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":412},{"name":"$j","line":412,"kind":13,"containerName":"_get_stat_from_clickhouse_fix"},{"defintion":"my","name":"$where_levels","line":415,"kind":13,"containerName":"_get_stat_from_clickhouse_fix"},{"kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":415,"name":"$cond"},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":416,"name":"$raw_clickhouse_metrics","defintion":"my"},{"line":417,"kind":13,"containerName":"_get_stat_from_clickhouse_fix","defintion":"my","name":"$retry_no"},{"name":"$SELECT_RETRY_COUNT","kind":13,"containerName":"_get_stat_from_clickhouse_fix","line":417},{"name":"$raw_clickhouse_metrics","containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":418},{"name":"$where_dates","containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":419},{"name":"$where_levels","line":419,"kind":13,"containerName":"_get_stat_from_clickhouse_fix"},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":421,"name":"$raw_clickhouse_metrics"},{"name":"$retry_no","line":422,"kind":13,"containerName":"_get_stat_from_clickhouse_fix"},{"containerName":"_get_stat_from_clickhouse_fix","kind":13,"line":422,"name":"$SELECT_RETRY_COUNT"},{"line":424,"kind":13,"containerName":"_get_stat_from_clickhouse_fix","name":"$raw_clickhouse_metrics"},{"name":"$raw_clickhouse_metrics","line":424,"kind":13,"containerName":"_get_stat_from_clickhouse_fix"}],"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12},{"name":"Founder","kind":12,"containerName":"Subscription::Level","line":405},{"name":"select_by_owner_id","containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":405},{"line":406,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"price"},{"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":407,"name":"price"},{"name":"price","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":407},{"line":412,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","name":"id"},{"name":"id","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":412},{"line":418,"containerName":"Clickhouse::Client","kind":12,"name":"MR"},{"name":"send_query","kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog","line":418},{"name":"MR","containerName":"ActiveRecordPg","kind":12,"line":427},{"containerName":"Founder::Stat::Aggr::Model::Blog","kind":12,"line":429,"name":"meta"},{"name":"make_immutable","line":429,"kind":12,"containerName":"Founder::Stat::Aggr::Model::Blog"}]